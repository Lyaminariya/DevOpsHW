Параметры playbook:
hosts: remote_server - определяет, на каком удаленном сервере будут выполняться задачи из playbook.

become: yes - указывает Ansible на необходимость выполнения задач с привилегиями суперпользователя (через sudo или su).

Переменные (vars):
username: Имя пользователя, который будет создан на удаленном сервере.

ssh_key: Публичный SSH-ключ, который будет добавлен в файл authorized_keys нового пользователя. В данном случае используется функция lookup для чтения содержимого файла, который содержит этот ключ.

directory_path: Путь к директории, которая будет создана на удаленном сервере.

Создание пользователя: Использует модуль user для создания пользователя с именем, определенным в переменной username. Опция state: present гарантирует, что пользователь будет создан, если его еще нет на сервере.

Добавление SSH-ключа в authorized_keys: Использует модуль authorized_key, чтобы добавить содержимое указанного публичного SSH-ключа (полученного с помощью lookup) в файл authorized_keys для указанного пользователя.

Создание директории: С помощью модуля file создает директорию по указанному пути (directory_path) с заданными правами доступа (mode: '0755').

Запустить playbook можно с помощью команды ansible-playbook -i hosts.ini setup_server.yml

Для этого нужно иметь файл hosts.ini

Пример файла hosts.ini:

[servers]
server1 ansible_host=your_server_ip

[all:vars]
ansible_user=ваш_пользователь
ansible_ssh_private_key_file=путь_до_вашего_приватного_ключа

